apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: argocd

resources:
- ../../base
- ingress.yaml
- regcred.yaml

configMapGenerator:
- behavior: merge
  files: 
  - env/resource.customizations
  - env/resource.exclusions
  name: argocd-cm
- behavior: merge
  files:
  - env/policy.csv
  - env/policy.default
  name: argocd-rbac-cm

patchesStrategicMerge:
- server.yaml

patchesJson6902:
- target:
    group: apps
    version: v1
    kind: Deployment
    name: argocd-redis
  path: patch/redis/sc-patch.yaml